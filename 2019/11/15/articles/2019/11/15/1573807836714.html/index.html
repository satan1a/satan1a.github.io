<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="从一道题看内存取证与图片隐写图：没有啥关系，但是当作一个封面的图片  这是第三届红帽杯的Misc题目：Advertising for Marriage，一道做了挺久，但是还是差一个关键步骤的题目。在做题过程中也学到了新的内存取证的知识，因此以此题作为切入，写下本篇WP&#x2F;学习笔记。 题目：题目内容以下为题目： 题目下载某云备份：q4nw ⚠️注意：这次题目，给我的一个很大教训就是，题目中的信息！Mi">
<meta property="og:type" content="article">
<meta property="og:title" content="从一道题看内存取证与图片隐写">
<meta property="og:url" content="https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/index.html">
<meta property="og:site_name" content="喵了个咪乎 Cat My Dog">
<meta property="og:description" content="从一道题看内存取证与图片隐写图：没有啥关系，但是当作一个封面的图片  这是第三届红帽杯的Misc题目：Advertising for Marriage，一道做了挺久，但是还是差一个关键步骤的题目。在做题过程中也学到了新的内存取证的知识，因此以此题作为切入，写下本篇WP&#x2F;学习笔记。 题目：题目内容以下为题目： 题目下载某云备份：q4nw ⚠️注意：这次题目，给我的一个很大教训就是，题目中的信息！Mi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115165611.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113004921.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113005806.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014150.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014305.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014411.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014444.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115163046.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191114085728.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115154928.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115155057.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115155155.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115084448.png">
<meta property="og:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115163811.png">
<meta property="article:published_time" content="2019-11-15T08:50:36.000Z">
<meta property="article:modified_time" content="2019-11-26T01:07:09.000Z">
<meta property="article:author" content="Toky">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="DigtalForensics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115165611.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>从一道题看内存取证与图片隐写</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="喵了个咪乎 Cat My Dog" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Project">Projects</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="https://y1ng.cc/" target="_blank" rel="noopener">BBS</a></li>
         
          <li><a href="/books">Books</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/11/16/articles/2019/11/16/1573845532259.html/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/11/06/articles/2019/11/06/1573041978645.html/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&text=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&is_video=false&description=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=从一道题看内存取证与图片隐写&body=Check out this article: https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&name=从一道题看内存取证与图片隐写&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&t=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#从一道题看内存取证与图片隐写"><span class="toc-number">1.</span> <span class="toc-text">从一道题看内存取证与图片隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#题目："><span class="toc-number">1.1.</span> <span class="toc-text">题目：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目内容"><span class="toc-number">1.1.1.</span> <span class="toc-text">题目内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#题目下载"><span class="toc-number">1.1.2.</span> <span class="toc-text">题目下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#⚠️注意："><span class="toc-number">1.1.3.</span> <span class="toc-text">⚠️注意：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#✈️启发："><span class="toc-number">1.1.4.</span> <span class="toc-text">✈️启发：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#做题笔记"><span class="toc-number">1.2.</span> <span class="toc-text">做题笔记</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解题过程"><span class="toc-number">1.3.</span> <span class="toc-text">解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#判断文件-题目类型"><span class="toc-number">1.3.1.</span> <span class="toc-text">判断文件&#x2F;题目类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发现图片隐写"><span class="toc-number">1.3.2.</span> <span class="toc-text">发现图片隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#⚠️知识点补充"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">⚠️知识点补充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#恢复正常尺寸"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">恢复正常尺寸</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#🔧工具推荐"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">🔧工具推荐</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发现LSB隐写"><span class="toc-number">1.3.3.</span> <span class="toc-text">发现LSB隐写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#✈️-CTF图片隐写题到手三连"><span class="toc-number">1.4.</span> <span class="toc-text">✈️ CTF图片隐写题到手三连</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PNG-图片相关"><span class="toc-number">1.5.</span> <span class="toc-text">PNG 图片相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PNG-文件结构"><span class="toc-number">1.5.1.</span> <span class="toc-text">PNG 文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图像深度"><span class="toc-number">1.5.2.</span> <span class="toc-text">图像深度</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#💡CTF-图片隐写题Tips"><span class="toc-number">1.6.</span> <span class="toc-text">💡CTF 图片隐写题Tips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#⌨内存取证其他调查"><span class="toc-number">1.7.</span> <span class="toc-text">⌨内存取证其他调查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结一下"><span class="toc-number">1.8.</span> <span class="toc-text">小结一下</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">1.9.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        从一道题看内存取证与图片隐写
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">喵了个咪乎 Cat My Dog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-11-15T08:50:36.000Z" itemprop="datePublished">2019-11-15</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link" href="/tags/DigtalForensics/" rel="tag">DigtalForensics</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="从一道题看内存取证与图片隐写"><a href="#从一道题看内存取证与图片隐写" class="headerlink" title="从一道题看内存取证与图片隐写"></a>从一道题看内存取证与图片隐写</h1><p><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115165611.png" alt="封面"><br>图：没有啥关系，但是当作一个封面的图片 </p>
<p>这是第三届红帽杯的Misc题目：Advertising for Marriage，一道做了挺久，但是还是差一个关键步骤的题目。在做题过程中也学到了新的内存取证的知识，因此以此题作为切入，写下本篇WP/学习笔记。</p>
<h2 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h2><h3 id="题目内容"><a href="#题目内容" class="headerlink" title="题目内容"></a>题目内容</h3><p>以下为题目：<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113004921.png" alt="题目" style="zoom:50%;" /></p>
<h3 id="题目下载"><a href="#题目下载" class="headerlink" title="题目下载"></a>题目下载</h3><p>某云备份：<a href="https://pan.baidu.com/s/19IReJhHKDNa7EC4cjGSpaw" target="_blank" rel="noopener">q4nw</a></p>
<h3 id="⚠️注意："><a href="#⚠️注意：" class="headerlink" title="⚠️注意："></a>⚠️注意：</h3><p>这次题目，给我的一个很大教训就是，题目中的信息！Misc作为CTF中的一种题型，它的特点之一就是“脑洞”和“列文虎克”般的观察能力以及对信息的逻辑整合能力。<br>题目中的 “Someone want” 其实在题目最后几个步骤中，是一个很重要的提示——确定这个someone是谁，也就是补充完整后面得到的密钥内容（hint，后面会讲到）。  </p>
<h3 id="✈️启发："><a href="#✈️启发：" class="headerlink" title="✈️启发："></a>✈️启发：</h3><p>本题作为一道内存取证题，体现的考察内容，其实不单单与解题的工具、技巧有关，很大程度上也是考察一种通用能力：<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113005806.png" alt="TK公开课" style="zoom:50%;" /><br>（来自TK的公开课，<a href="https://www.leiphone.com/news/201704/4qTw6sbX8AlTlbOs.html" target="_blank" rel="noopener">链接</a>）<br>其中，我们可以看到，对Misc/取证分析题目的信息进行分析的能力（是否为hint？）判断能力（是否重要？）规划能力（解题的总体步骤和阶段性步骤？）搜集能力（哪些地方得到信息？）学习能力（如何获取信息？）提炼能力（信息间如何进行整合？）都是非常重要的，对做题还是其他的学习和生活。<br><strong>努力提高自己的通用能力，能想清楚，能写清楚，能讲清楚，逻辑严密，语句通顺，表达清晰</strong>。“无论以后你想从事什么工作，在学生时代加强这些能力的培养，对你整个人生都会有很大的帮助。”    ——TK</p>
<h2 id="做题笔记"><a href="#做题笔记" class="headerlink" title="做题笔记"></a>做题笔记</h2><p>以下是我做题时的一些笔记，有些并不正确或者对解该题没有帮助，放在这里，记录自己的想法：</p>
<ol>
<li><p>查看可能是个Windows磁盘镜像<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014150.png" alt="可疑文件"><br>发现可疑文件，但可能只是用户的头像，注意时间</p>
</li>
<li><p>发现cookies文件<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014305.png" alt="cookies文件"></p>
</li>
</ol>
<p>010打开发现全为空00</p>
<ol start="3">
<li>发现桌面PNG文件</li>
<li>Stegsolve打开<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014411.png" alt="Stegsolve打开"><br>眼睛上像不像二维码？？  &gt; <a href="https://xz.aliyun.com/t/2788" target="_blank" rel="noopener">https://xz.aliyun.com/t/2788</a></li>
<li>IHDR报错，猜测修改宽高，计算CRC<br>计算得211，修改IHDR，显示正常</li>
<li>发现IDAT有问题<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191113014444.png" alt="IDAT问题"></li>
<li>扩展：PNG图像隐写<br><a href="https://3gstudent.github.io/3gstudent.github.io/%E9%9A%90%E5%86%99%E6%8A%80%E5%B7%A7-%E5%88%A9%E7%94%A8PNG%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E9%9A%90%E8%97%8FPayload/" target="_blank" rel="noopener">https://3gstudent.github.io/3gstudent.github.io/%E9%9A%90%E5%86%99%E6%8A%80%E5%B7%A7-%E5%88%A9%E7%94%A8PNG%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E9%9A%90%E8%97%8FPayload/</a></li>
<li>尝试LSB<br>使用工具<a href="https://github.com/livz/cloacked-pixel" target="_blank" rel="noopener">https://github.com/livz/cloacked-pixel</a></li>
<li>去除了IEND后面（82）的00</li>
</ol>
<h2 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h2><h3 id="判断文件-题目类型"><a href="#判断文件-题目类型" class="headerlink" title="判断文件/题目类型"></a>判断文件/题目类型</h3><p>首先，拿到题目文件，使用binwalk分析，判断文件类型（输出到txt文件，方便查询信息）</p>
<figure class="highlight plain"><figcaption><span>xxx.raw > fileInfo.txt```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">可以看到其中有很多Microsoft到信息，且文件形式中很类似于磁盘文件，可以初步判断这是一个Windows磁盘镜像，这很有可能是一道内存取证题。</span><br><span class="line">&gt; ⚠️注意：此时，判断好类型题目，就应该在心态上调整过来，这是一道取证分析题目，取证分析 &#x3D; 取证 + 分析，因此，在做题过程中，核心就是做细致的取证工作，获取充分的信息，以及很重要的逻辑分析、串联、整合、归纳。  </span><br><span class="line"></span><br><span class="line">### 查看镜像信息</span><br><span class="line"></span><br><span class="line">接下来，确定此为磁盘镜像后，使用内存取证工具&#96;&#96;&#96;Volatility&#96;&#96;&#96;**查看镜像信息**（常常含有出题人的hint）：</span><br><span class="line">&#96;&#96;&#96;volatility imageinfo -f xxx.raw</span><br></pre></td></tr></table></figure>
<p><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115163046.png" alt="查看镜像信息"><br>图：查看镜像信息</p>
<p>从结果中，可以看到，Suggest Profile为WinXPSP2x86，也就是，Volatility对该镜像文件的架构识别为WinXPSP2x86，此后对该镜像的很多操作，都需要指定预设，例如 <code> --profile WinXPSP2x86</code>。因此，需要将磁盘镜像中的这个关键信息记录下来，以备后面使用。</p>
<p>💡Tips：可以列举该架构可以使用的命令, e.g.</p>
<figure class="highlight plain"><figcaption><span>-f xxx.raw --profile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 方式一：使用DiskGenius</span><br><span class="line"></span><br><span class="line">使用数据恢复综合软件DiskGenius打开虚拟磁盘——恢复文件，可以直接以GUI的形式看到磁盘镜像的内容。然后需要不断翻阅文件目录，寻找可疑的文件&#x2F;文件夹（重点看一下桌面）。</span><br><span class="line">![vegetable.png](https:&#x2F;&#x2F;image-host-toky.oss-cn-shanghai.aliyuncs.com&#x2F;vegetable_origin.png)  </span><br><span class="line">图·桌面的vegetable.png</span><br><span class="line"></span><br><span class="line">发现桌面可疑文件 vegetable.png，PNG图片，恢复可得，根据图片内容猜测为图片隐写。</span><br><span class="line"></span><br><span class="line">### 方式二：使用Volatility</span><br><span class="line"></span><br><span class="line">使用Volatility可以更加方便于严谨地分析文件的内容。具体的教程可以查看该博客：[链接](https:&#x2F;&#x2F;mengsec.com&#x2F;2018&#x2F;10&#x2F;20&#x2F;CTF-Volatility&#x2F;)  </span><br><span class="line">1. 首先，**查看进程：**</span><br></pre></td></tr></table></figure>
<p>volatility pslist -f xxx.raw</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; TODO 图·进程显示</span><br><span class="line">pslist可以用来列出运行的进程。如果Exit所在的一列显示了日期时间，则表明该进程已经结束了。 在图中，我们看到，存在notepad.exe, mspaint.exe，也就是取证对象（出题人）使用过记事本、画图程序。</span><br><span class="line">&gt; 在查看进程的显示时，注意一下记事本程序notepad.exe, 画画工具mspaint.exe以及DumpIt等使用过的软件，这些就是取证对象的操作，其中很有可能有重要信息。因此在逻辑清晰的一个做题过程中，我们需要对取证对象的操作，分别进行纵向地分析，然后回过头来结合起来进行分析。   </span><br><span class="line">&gt;</span><br><span class="line">Dumpit.exe 一款内存镜像提取工具</span><br><span class="line">TrueCrypt.exe 一款磁盘加密工具</span><br><span class="line">Notepad.exe windows自带的记事本</span><br><span class="line">Mspaint,exe windows自带画图工具</span><br><span class="line"></span><br><span class="line">2. **查看notepad.exe**</span><br><span class="line"></span><br><span class="line">如果需要查看Notepad程序编辑的内容，需要使用Volatility的Notepad插件：</span><br></pre></td></tr></table></figure>
<p>volatility notepad -f xxx.raw </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">![Notepad中的Hint](https:&#x2F;&#x2F;image-host-toky.oss-cn-shanghai.aliyuncs.com&#x2F;20191115163249.png)</span><br><span class="line">图·Notepad中的Hint  </span><br><span class="line">可以看到提示：&#96;&#96;&#96;hint:????needmoneyandgirlfirend&#96;&#96;&#96;。  </span><br><span class="line"></span><br><span class="line">⚠️注意：在做题过程中，我忽略了hint中的问号????，这个其实是个重要的提示，结合前面题目中的提示 Someone want，可以推测出，这是让我们确定someone的名字，而且这个句子在一个内存取证结合图片隐写（后面会发现）的题目中，很有可能是一个密钥key。</span><br><span class="line"></span><br><span class="line">3. **查看mspaint.exe**</span><br><span class="line"></span><br><span class="line">接下来，我们查看内存操作中对画图程序操作的内容，使用插件mspaint。</span><br><span class="line">详细教程查看：[《利用volatility与Gimp实现Windows内存取证》](https:&#x2F;&#x2F;segmentfault.com&#x2F;a&#x2F;1190000018813033)</span><br><span class="line"></span><br><span class="line">可以看到mspaint进程pid号，为332，dump下来</span><br></pre></td></tr></table></figure>
<p>volatility -f Advertising_for_Marriage.raw –profile=WinXPSP2x86 memdump -p 332 –dump-dir=./</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">生成332.dmp修改后缀为332.data，用gimp打开，偏移量（offset）即为分辨率，又因为该系统为Window XP系统，分辨率一般为800x768&#x3D;614400。设置分辨率，可得：</span><br><span class="line"></span><br><span class="line">&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;image-host-toky.oss-cn-shanghai.aliyuncs.com&#x2F;20191126090113.png&quot; alt&#x3D;&quot;设置偏移量后的332.data&quot; style&#x3D;&quot;zoom:50%;&quot; &#x2F;&gt;</span><br><span class="line">黄色部分很像菠萝，细看有字母需要图片变换，水平翻转180度，垂直镜像翻转可得：</span><br><span class="line">![菠萝图](https:&#x2F;&#x2F;image-host-toky.oss-cn-shanghai.aliyuncs.com&#x2F;20191126090046.png)</span><br><span class="line"></span><br><span class="line">得到字符 &#96;&#96;&#96;b1cx&#96;&#96;&#96;，结合之前，缺少的四个字符（？？？？），得到密钥：b1cxneedmoneyandgirlfriend。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4. 扫描文件</span><br><span class="line"></span><br><span class="line">使用Volatility中的filescan功能，保存为txt，方便后续查找分析：</span><br></pre></td></tr></table></figure>
<p>volatility filescan -f xxx.raw –profile=WinXPSP2x86 &gt; filescanInfo.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">通过内存取证操作（见后面列举），查找到PNG图片</span><br></pre></td></tr></table></figure>
<p>volatility filescan -f Advertising\ for\ Marriage.raw –profile=WinXPSP2x86 | grep “jpg|jpeg|png|tif|gif|bmp”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">![Volatility文件扫描](https:&#x2F;&#x2F;image-host-toky.oss-cn-shanghai.aliyuncs.com&#x2F;20191115164548.png)</span><br><span class="line">图·Volatility扫描图片  </span><br><span class="line"></span><br><span class="line">导出图片：</span><br><span class="line">&#96;&#96;&#96;volatility -f xxx.raw dumpfiles -Q 0x000000000249ae78 -D --dump-dir&#x3D;.&#x2F;</span><br></pre></td></tr></table></figure>



<h3 id="发现图片隐写"><a href="#发现图片隐写" class="headerlink" title="发现图片隐写"></a>发现图片隐写</h3><p>Linux 打开vegetable.png发现提示IHDR：CRC 错误，Windows可以正常打开，可以猜测图片尺寸被修改了。</p>
<h4 id="⚠️知识点补充"><a href="#⚠️知识点补充" class="headerlink" title="⚠️知识点补充"></a>⚠️知识点补充</h4><p>PNG格式图片的文件头为：89 50 4E 47 0D 0A 1A 0A，该段格式是固定的。windows的图片查看器会忽略错误的CRC校验码，因此会显示图片，但此时的图片已经是修改过的，所以会有显示不全或扭曲等情况，借此可以隐藏信息。<br>而Linux下的图片查看器不会忽略错误的CRC校验码，因此用Linux打开修改过宽或高的png图片时，会出现打不开的情况</p>
<h4 id="恢复正常尺寸"><a href="#恢复正常尺寸" class="headerlink" title="恢复正常尺寸"></a>恢复正常尺寸</h4><p>使用脚本计算正确的CRC校验值，并恢复其正常尺寸：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">img = open(<span class="string">"vegetable.png"</span>, <span class="string">"rb"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> range(<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(<span class="number">1024</span>):</span><br><span class="line">        data = img[<span class="number">0xc</span>:<span class="number">0x10</span>] + struct.pack(<span class="string">'&gt;i'</span>,w) + struct.pack(<span class="string">'&gt;i'</span>,h) + img[<span class="number">0x18</span>:<span class="number">0x1d</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc32 == struct.unpack(<span class="string">'&gt;i'</span>,img[<span class="number">0x1d</span>:<span class="number">0x21</span>])[<span class="number">0</span>] &amp; <span class="number">0xffffffff</span>:</span><br><span class="line">            <span class="keyword">print</span> w, h</span><br><span class="line">            <span class="keyword">print</span> hex(w), hex(h)</span><br><span class="line">            <span class="comment"># 直接恢复图片正常尺寸，保存为新的图片</span></span><br><span class="line">            open(<span class="string">"vegetable_new.png"</span>, <span class="string">"wb"</span>).write(img[:<span class="number">0xc</span>] + data + img[<span class="number">0x1d</span>:])</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>



<h4 id="🔧工具推荐"><a href="#🔧工具推荐" class="headerlink" title="🔧工具推荐"></a>🔧工具推荐</h4><p>使用pngcheck可以对PNG图片进行检测：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pngcheck -v xxx.png</span><br></pre></td></tr></table></figure>
<p>010Editor具有template检测功能，会检测出图片被修改后的很多报错信息，这也是一个好提示：<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191114085728.png" alt="010Editor提示" style="zoom:50%;" /></p>
<h3 id="发现LSB隐写"><a href="#发现LSB隐写" class="headerlink" title="发现LSB隐写"></a>发现LSB隐写</h3><p>结合Hint中的文字提示，结合Stegsolve查看图片分析，可以判断其为LSB隐写（详细介绍在后面的PNG图片相关章节），具体的LSB隐写分析如下：<br>在对vegetable.png使用Stegsolve查看时，切换不同的通道，发现在Red plane1,Blue plane1, Green plane1, 图片上方存在异常，显示为一个横条，由此可猜测为LSB隐写：<br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115154928.png" alt="Red plane1"><br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115155057.png"><br><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115155155.png" alt="Green plane1"></p>
<p>使用<a href="https://github.com/livz/cloacked-pixel" target="_blank" rel="noopener">cloacked-pixel</a>工具，使用密钥进行解密：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python lsb.py extract .&#x2F;vegetable.png out b1cxneedmoneyandgirlfirend</span><br></pre></td></tr></table></figure>
<p>Base64解密，维吉尼亚解密（密钥相同）即可。</p>
<h2 id="✈️-CTF图片隐写题到手三连"><a href="#✈️-CTF图片隐写题到手三连" class="headerlink" title="✈️ CTF图片隐写题到手三连"></a>✈️ CTF图片隐写题到手三连</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查看图片明文字符串</span><br><span class="line">strings xxx.png</span><br><span class="line"># binwalk分析，</span><br><span class="line">binwalk xxx.png -f picInfo.txt</span><br><span class="line"># foremost 切分图片</span><br><span class="line">foremost xxx.png -o output_xxx</span><br></pre></td></tr></table></figure>

<h2 id="PNG-图片相关"><a href="#PNG-图片相关" class="headerlink" title="PNG 图片相关"></a>PNG 图片相关</h2><p>此处探讨PNG图片的文件结构等数字特征，了解这些对解题很有帮助。PNG（Portable Network Graphics，便携式网络图形），从名字上看，这就是一种适用于网络传输的格式。</p>
<h3 id="PNG-文件结构"><a href="#PNG-文件结构" class="headerlink" title="PNG 文件结构"></a>PNG 文件结构</h3><p>Refer: <a href="https://www.w3.org/TR/PNG/#5ChunkOrdering" target="_blank" rel="noopener">详细的参考</a>  </p>
<p><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115084448.png" alt="PNG文件结构"><br>从上图可知，一个标准的PNG图片文件结构包含：</p>
<ol>
<li>PNG文件标志，即文件头：89 50 4e 47 0d 0a 1a 0a。这8位是不会变的。</li>
<li>PNG数据块：  </li>
</ol>
<ul>
<li><p>关键数据块：定义了4种标准数据块</p>
</li>
<li><p>辅助数据块：</p>
<ul>
<li><p>IHDR<br>文件头数据块IHDR是PNG文件中的第一个数据块（即在文件头之后, 0A之后），而且一个PNG文件中只能有一个文件头数据块，它包含PNG文件中存储的图像数据的基本信息，e.g. 宽，高，图像深度，图像类型，压缩方法等。  </p>
<p>💡Tips：如何找到和修改16进制编辑器下的图片宽和高？查看图分辨率（10进制），转换为16进制，在16进制编辑器中查找，在IHDR部分的就是宽和高。  </p>
<p>🎯出题点：比赛中经常通过改变宽和高使得图片显示不完整或者无法显示从而达到隐藏信息的目的。对于这种情况，我们不能轻易修改图片的宽或高的值，应该通过CRC的值推算出宽或高的值，使用脚本计算；或者是修改宽或高的值后，计算修改后的CRC，计算得出新的CRC值替换原本的值，以防图片报错打不开。  </p>
</li>
</ul>
<ul>
<li><p>PLTE<br>  调色板数据块 PLTE（palette chunk），包含：索引彩色图像（indexed-color image）相关的彩色变换数据，其仅与索引彩色图像有关，而且要放在图像数据块（image data chunk）之前。真彩色的 PNG 数据流也可以有调色板数据块，目的是便于非真彩色显示程序用它来量化图像数据，从而显示该图像。<br>🎯题目：一道和PLTE有关的题 &gt; <a href="https://rawsec.ml/en/fit-hack-2017-write-ups/" target="_blank" rel="noopener">链接</a>  </p>
</li>
<li><p>IDAT<br>图像数据块 IDAT（image data chunk）：它存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。这是一个可以存在多个数据块类型的数据块。它的作用就是<strong>存储着图像真正的数据</strong>。IDAT采用 LZ77 算法的派生算法进行压缩，可以用 zlib 解压缩（因此有时候foremost切割PNG会出现一些打不开的压缩包）。值得注意的是，<strong>IDAT 块只有当上一个块充满时，才会继续一个新的块</strong>。因此，做PNG隐写时，一定使用pngcheck查看一下PNG的文件结构信息，注意一下IDAT是否有出现没有填充满就开始新的一个数据块的情况（正常充满的长度应该是<strong>65524</strong>）。  </p>
<p>🎯出题点：此处是出题的重灾区，常见的是LSB隐写（详细介绍教程：<a href="https://3gstudent.github.io/%E9%9A%90%E5%86%99%E6%8A%80%E5%B7%A7-PNG%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84LSB%E9%9A%90%E5%86%99/" target="_blank" rel="noopener">链接</a>）：</p>
<blockquote>
<p>LSB全称least significant bit，最低有效位<br>PNG文件中的图像像数一般是由RGB三原色（红绿蓝）组成，每一种颜色占用8位，取值范围为0x00~0xFF，即有256种颜色，一共包含了256的3次方的颜色，即16777216 种颜色<br>人类的眼睛可以区分约1000万种不同的颜色<br>这意味着人类的眼睛无法区分余下的颜色大约有6777216种<br>LSB隐写就是<strong>修改RGB颜色分量的最低二进制位（LSB）</strong>，而人类的眼睛不会注意到这前后的变化<br>每个像数可以携带3比特的信息<br>🔧工具推荐：<a href="https://github.com/livz/cloacked-pixel" target="_blank" rel="noopener">cloacked-pixel</a> LSB隐写加解密工具，还有analyse功能，可以进行LSB检测  </p>
</blockquote>
<ul>
<li>IEND<br>图像结束数据 IEND（image trailer chunk）：它用来标记 PNG 文件或者数据流已经结束，并且必须要放在文件的尾部。<strong>IEND 数据块的长度总是 00 00 00 00</strong>，<strong>数据标识总是 IEND 49 45 4E 44</strong>，因此，<strong>CRC 码也总是 AE 42 60 82</strong>。<br>🎯出题点：这些PNG图片固定的文件信息，一定要在分析图片时熟记，不用记住具体的值，但要对这些开始、结束等标志熟悉。有时在这些固定的信息附近，会有多余信息要去除。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="图像深度"><a href="#图像深度" class="headerlink" title="图像深度"></a>图像深度</h3><p>PNG用来存储灰度图像时，灰度图像的深度可达16位，存储彩色图像时，彩色图像的深度可达48位，并且还可存储多达16位的α通道数据。图像深度信息保存在文件头数据块IHDR中。</p>
<h2 id="💡CTF-图片隐写题Tips"><a href="#💡CTF-图片隐写题Tips" class="headerlink" title="💡CTF 图片隐写题Tips"></a>💡CTF 图片隐写题Tips</h2><ol>
<li>Windows、Linux分别打开，看图片内容信息，将图片中的信息与题目、其他的hint写在一个文件里，做逻辑信息提炼、关联、整合</li>
<li>右键图片，查看图片信息，其中可能会有提示</li>
<li>英文搜索很重要，很多隐写技术还没有被“翻译”和应用</li>
</ol>
<h2 id="⌨内存取证其他调查"><a href="#⌨内存取证其他调查" class="headerlink" title="⌨内存取证其他调查"></a>⌨内存取证其他调查</h2><p>查看文档</p>
<figure class="highlight plain"><figcaption><span>-f xxx.raw --profile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">查看图片</span><br><span class="line">&#96;&#96;&#96;volatility -f xxx.raw --profile&#x3D;WinXPSP2x86 filescan | grep &quot;jpg\|jpeg\|png\|tif\|gif\|bmp&quot;</span><br></pre></td></tr></table></figure>
<p><img src="https://image-host-toky.oss-cn-shanghai.aliyuncs.com/20191115163811.png" alt="查看桌面"></p>
<p>查看桌面</p>
<figure class="highlight plain"><figcaption><span>-f xxx.raw --profile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">查看命令行输入</span><br><span class="line">&#96;&#96;&#96;volatility -f xxx.raw --profile&#x3D;WinXPSP2x86 cmdline</span><br></pre></td></tr></table></figure>

<p>查看系统用户名</p>
<figure class="highlight plain"><figcaption><span>-f xxx.raw --profile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">查看网络连接</span><br><span class="line">&#96;&#96;&#96;volatility -f mem.data --profile&#x3D;WinXPSP2x86 netscan</span><br></pre></td></tr></table></figure>




<h2 id="小结一下"><a href="#小结一下" class="headerlink" title="小结一下"></a>小结一下</h2><ol>
<li>熟悉使用各类取证分析工具，是快速解题的关键</li>
<li>参透出题人心理，猜测可能的flag位置</li>
<li>对Hint信息仔细观察并进行逻辑串联，不要忽视Hint中的部分信息</li>
</ol>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a href="https://segmentfault.com/a/1190000018813033" target="_blank" rel="noopener">https://segmentfault.com/a/1190000018813033</a><br>[2] <a href="https://cloud.tencent.com/developer/article/1527140" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1527140</a><br>[3] <a href="https://www.cnblogs.com/WangAoBo/p/7108278.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/7108278.html</a><br>[4] <a href="https://xz.aliyun.com/t/1836" target="_blank" rel="noopener">https://xz.aliyun.com/t/1836</a></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Project">Projects</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="https://y1ng.cc/" target="_blank" rel="noopener">BBS</a></li>
         
          <li><a href="/books">Books</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#从一道题看内存取证与图片隐写"><span class="toc-number">1.</span> <span class="toc-text">从一道题看内存取证与图片隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#题目："><span class="toc-number">1.1.</span> <span class="toc-text">题目：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目内容"><span class="toc-number">1.1.1.</span> <span class="toc-text">题目内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#题目下载"><span class="toc-number">1.1.2.</span> <span class="toc-text">题目下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#⚠️注意："><span class="toc-number">1.1.3.</span> <span class="toc-text">⚠️注意：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#✈️启发："><span class="toc-number">1.1.4.</span> <span class="toc-text">✈️启发：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#做题笔记"><span class="toc-number">1.2.</span> <span class="toc-text">做题笔记</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解题过程"><span class="toc-number">1.3.</span> <span class="toc-text">解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#判断文件-题目类型"><span class="toc-number">1.3.1.</span> <span class="toc-text">判断文件&#x2F;题目类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发现图片隐写"><span class="toc-number">1.3.2.</span> <span class="toc-text">发现图片隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#⚠️知识点补充"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">⚠️知识点补充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#恢复正常尺寸"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">恢复正常尺寸</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#🔧工具推荐"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">🔧工具推荐</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发现LSB隐写"><span class="toc-number">1.3.3.</span> <span class="toc-text">发现LSB隐写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#✈️-CTF图片隐写题到手三连"><span class="toc-number">1.4.</span> <span class="toc-text">✈️ CTF图片隐写题到手三连</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PNG-图片相关"><span class="toc-number">1.5.</span> <span class="toc-text">PNG 图片相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PNG-文件结构"><span class="toc-number">1.5.1.</span> <span class="toc-text">PNG 文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图像深度"><span class="toc-number">1.5.2.</span> <span class="toc-text">图像深度</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#💡CTF-图片隐写题Tips"><span class="toc-number">1.6.</span> <span class="toc-text">💡CTF 图片隐写题Tips</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#⌨内存取证其他调查"><span class="toc-number">1.7.</span> <span class="toc-text">⌨内存取证其他调查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结一下"><span class="toc-number">1.8.</span> <span class="toc-text">小结一下</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">1.9.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&text=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&is_video=false&description=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=从一道题看内存取证与图片隐写&body=Check out this article: https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&title=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&name=从一道题看内存取证与图片隐写&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://y1ng.org/2019/11/15/articles/2019/11/15/1573807836714.html/&t=从一道题看内存取证与图片隐写" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 Toky
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Project">Projects</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="https://y1ng.cc/" target="_blank" rel="noopener">BBS</a></li>
         
          <li><a href="/books">Books</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-157954403-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'y1ng-org-1';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
